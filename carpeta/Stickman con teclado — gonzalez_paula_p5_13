<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Paula if</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  </head>
  <body>
  <script>
  //definimos variables
  let xS,yS,dS,rS,vS;
  let xL,yL,dL,rL,vL;
  let dia,mes,anio;
  let xP,yP;
  let S;
  let vP;
  let groundY;
  let vY;
  let jumpV;
  let g;
  let rHead;
  let bodyL;
  let armL;
  let legL;
  let hipY;          
  let shoulderY; 
  let headY; 
  function setup () {
  createCanvas (800,800);
  //ponemos las medidas
  //sol
  dS =0.18*width;
  rS= dS/2;
  yS =0.35*height; 
  xS= -rS;
  vS= width/40; 
  //luna
  dL= dS*0.5;
  rL=dL/2;
  xL=-width-6*rL;
  yL=height/3;
  vL=vS;
  //Suelo (decoración)
  noStroke();
  fill(20, 120, 40);
  rect(0, 0.8*height, width, 0.2*height);
  //calendario
  dia=1;
  mes=1;
  anio=2008;
  //letras
  textSize (20);
  fill (0);
  // Suelo (debe coincidir con el suelo que ya dibujas en T12)
  groundY = 0.80 * height;
  // Stickman: tamaño y posición inicial
  S= 0.12 * min(width, height);
  xP= 0.25 * width;
  yP= groundY; // IMPORTANTE: aquí yP será la posición de los pies
  //Muñequito
   rHead= 0.20 * S;
   bodyL = 0.60 * S;
   armL  = 0.45 * S;
   legL  = 0.55 * S;
   hipY = yP - legL; // cadera por encima de los pies
   shoulderY = hipY - bodyL;  // hombros por encima de la cadera
   headY = shoulderY - rHead; // centro de la cabeza
  // Movimiento horizontal
  vP = width / 150;
  // Salto (valores sencillos)
  vY = 0;
  jumpV = -0.030 * height; // impulso hacia arriba
  g = 0.0016 * height;// aceleración hacia abajo (pequeña)
  }
  function draw (){
  if (xS <= width + rS){
    // Día mientras el borde izquierdo del Sol no ha salido por la derecha
    background(135, 206, 235);   // azul
   } 
   else {
    // Noche cuando el Sol ya salió completamente por la derecha
    background(0);// negro
	
   }
  //Suelo (decoración)
  noStroke();
  fill(20, 120, 40);
  rect(0, 0.8*height, width, 0.2*height);
  //Luna 
  noStroke();
  fill(200);
  circle(xL,yL,dL);
  //velocidad
  xL +=vL;
  //Sol (si está fuera, no se verá)
  noStroke();
  fill(255, 210, 0);
  circle(xS, yS, dS);
  //medidas Sol
  xS +=vS;
  // 3.5 Reinicio por posición (noche suficientemente larga)
  if (xS > 2*width + rS) {
   xS = -rS;//reentrar por la izquierda
   xL= -width-6*rL;
   // Incremento la variable día.
   dia = dia + 1; 
  // Reseteo día e incremento mes si me paso de 30 días
  if (dia > 30) { dia = 1; mes = mes + 1;
  }
  // Reseteo mes e incremento año si me paso de 12 meses
  if (mes > 12) { mes = 1; anio = anio + 1; }
  }
  if (xS <= width + rS) {fill(0);}
  else {fill (255);} 
  //calendario
  text("Fecha: (" + dia + ") (" + mes + ") (" + anio + ")", 10, 20); 
  //color independiente de la posición del Sol
  if (keyIsDown(LEFT_ARROW)) {
  xP = xP - vP; } 
  else if (keyIsDown(RIGHT_ARROW)) {
  xP = xP + vP;
  }
  if (xP < 0) {
  xP = 0;
  }
  if (xP > width) {
  xP = width;
  }
  // Física mínima del salto (se ejecuta siempre) 
  vY = vY + g; 
  // gravedad 
  yP = yP + vY; // actualiza pies
// Si toca el suelo, corregimos 
if (yP > groundY) { yP = groundY; vY = 0; }
  hipY = yP - legL;
  shoulderY = hipY - bodyL;
  headY = shoulderY - rHead;
  stroke(159,107,191);
  strokeWeight(0.06 * S);
  noFill();
  // Cabeza
  circle(xP, headY, 2 * rHead);
  // Tronco
  line(xP, shoulderY, xP, hipY);
  // Brazos (una línea horizontal + dos líneas hacia abajo)
  line(xP - 0.25*S, shoulderY, xP + 0.25*S, shoulderY);
  line(xP - 0.25*S, shoulderY, xP - 0.25*S, shoulderY + armL);
  line(xP + 0.25*S, shoulderY, xP + 0.25*S, shoulderY + armL);
  // Piernas
  line(xP, hipY, xP - 0.18*S, yP);
  line(xP, hipY, xP + 0.18*S, yP);
  }
 function keyPressed() {
  if (keyCode === UP_ARROW) {
    // Solo saltamos si estamos en el suelo
    if (yP === groundY) {
      vY = jumpV;
    }
  }
}   
</script>
</body>
</html>
